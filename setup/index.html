
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../report_configs/">
      
      
        <link rel="next" href="../use_cases/">
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.2">
    
    
      
        <title>Setting up the spreadsheet - Budget Dance</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0e669242.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#setting-up-the-spreadsheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Budget Dance" class="md-header__button md-logo" aria-label="Budget Dance" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Budget Dance
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Setting up the spreadsheet
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Budget Dance" class="md-nav__button md-logo" aria-label="Budget Dance" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Budget Dance
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tool links accounting data with long term plans
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../data_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Files
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../data_from_moneydance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generating reports for data
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../idioms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Some Excel idioms & notes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../preserve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preserve definitions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use of Python
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../report_configs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Moneydance report definitions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Setting up the spreadsheet
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Setting up the spreadsheet
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps" class="md-nav__link">
    Summary of steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-key" class="md-nav__link">
    API key
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-setup-control-file" class="md-nav__link">
    The setup control file
  </a>
  
    <nav class="md-nav" aria-label="The setup control file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#global-settings" class="md-nav__link">
    Global Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheet-groups" class="md-nav__link">
    Sheet groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheets" class="md-nav__link">
    Sheets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-definitions" class="md-nav__link">
    Table Definitions
  </a>
  
    <nav class="md-nav" aria-label="Table Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#column-definitions" class="md-nav__link">
    Column definitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-definitions" class="md-nav__link">
    Data definitions
  </a>
  
    <nav class="md-nav" aria-label="Data definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-types" class="md-nav__link">
    Supported Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inserting-rows" class="md-nav__link">
    Inserting Rows
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actual-and-forecast-formulas" class="md-nav__link">
    Actual and Forecast Formulas
  </a>
  
    <nav class="md-nav" aria-label="Actual and Forecast Formulas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array-formulas" class="md-nav__link">
    Array formulas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-time-created-fields" class="md-nav__link">
    Build-time created fields
  </a>
  
    <nav class="md-nav" aria-label="Build-time created fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formula-specifics" class="md-nav__link">
    Formula Specifics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highlights" class="md-nav__link">
    Highlights
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-checks" class="md-nav__link">
    Edit Checks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specific-sheets-tables" class="md-nav__link">
    Specific Sheets &amp; Tables
  </a>
  
    <nav class="md-nav" aria-label="Specific Sheets & Tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inflation" class="md-nav__link">
    Inflation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-minimum-distributions" class="md-nav__link">
    Required minimum distributions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accounts" class="md-nav__link">
    Accounts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use-case procedures
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../vba_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VBA notes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../workbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design of the workbook
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../worksheets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Worksheets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../functions/excel_lambdas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defined Excel Lambda functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../functions/preserve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tables with preserve defined
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../functions/vba_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VBA Code Summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../functions/vba_sorted/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VBA Code
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Sheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accounts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/aux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/balances/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    balances
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/cap_gain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    capgn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/current/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    current
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/gen_tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gen_tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/iande/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iande
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/iande_actl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iande-actl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/invest_actl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    invest_actl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/invest_iande_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    invest_iande_work
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/other_actl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    other_actl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/retirement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    retirement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/retireparms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    retireparms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/tax_tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tax_tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/taxes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    taxes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/transfers_actl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transfers-actl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/transfers_plan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transfers_plan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sheets/utility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utility
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps" class="md-nav__link">
    Summary of steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-key" class="md-nav__link">
    API key
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-setup-control-file" class="md-nav__link">
    The setup control file
  </a>
  
    <nav class="md-nav" aria-label="The setup control file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#global-settings" class="md-nav__link">
    Global Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheet-groups" class="md-nav__link">
    Sheet groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheets" class="md-nav__link">
    Sheets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-definitions" class="md-nav__link">
    Table Definitions
  </a>
  
    <nav class="md-nav" aria-label="Table Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#column-definitions" class="md-nav__link">
    Column definitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-definitions" class="md-nav__link">
    Data definitions
  </a>
  
    <nav class="md-nav" aria-label="Data definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-types" class="md-nav__link">
    Supported Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inserting-rows" class="md-nav__link">
    Inserting Rows
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actual-and-forecast-formulas" class="md-nav__link">
    Actual and Forecast Formulas
  </a>
  
    <nav class="md-nav" aria-label="Actual and Forecast Formulas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array-formulas" class="md-nav__link">
    Array formulas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-time-created-fields" class="md-nav__link">
    Build-time created fields
  </a>
  
    <nav class="md-nav" aria-label="Build-time created fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formula-specifics" class="md-nav__link">
    Formula Specifics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highlights" class="md-nav__link">
    Highlights
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-checks" class="md-nav__link">
    Edit Checks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specific-sheets-tables" class="md-nav__link">
    Specific Sheets &amp; Tables
  </a>
  
    <nav class="md-nav" aria-label="Specific Sheets & Tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inflation" class="md-nav__link">
    Inflation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-minimum-distributions" class="md-nav__link">
    Required minimum distributions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accounts" class="md-nav__link">
    Accounts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="setting-up-the-spreadsheet">Setting up the spreadsheet</h1>
<h2 id="summary-of-steps">Summary of steps</h2>
<ol>
<li>Prepare data files. See <a href="../data_files/">Data Files</a>.<ol>
<li>Save certain reports from Moneydance to the <code>data</code> folder.</li>
<li>Prepare other imput files as json or tsv</li>
</ol>
</li>
<li><a href="#api-key">Acquire a registration key</a> for the bureau of labor statistics (for inflation data)</li>
<li>Edit the <a href="#the-setup-control-file">control file</a> as described below.</li>
<li>Validate the file against the schema.  I use VS Code extension <code>YAML Language Support by Red Hat</code></li>
<li>Run <code>dance/setup/create_wb.py</code></li>
</ol>
<h2 id="api-key">API key</h2>
<p>The system copies the inflation data to faciliatate planning.  To do this an API key is needed.  This is free; they only want an email address.  Register here: <a href="https://data.bls.gov/registrationEngine/">https://data.bls.gov/registrationEngine/</a>.  The API key should be stored in ./private/api_keys.yml. The rows of this file are expected to be simply a site code and the key value, such as below:</p>
<p><img alt="apikey" src="../images/tgt/api_key.png" /></p>
<h2 id="the-setup-control-file">The setup control file</h2>
<p>The control file is <code>.data/setup.yaml</code>.  To reference the schema insert the following line at the top:</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-0-1"># yaml-language-server: $schema=../dance/setup/setup_schema.json
</span></code></pre></div>
<h3 id="global-settings">Global Settings</h3>
<p>The following values are global in nature:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Item</th>
<th style="text-align: left;">Purpose</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">workbook</td>
<td style="text-align: left;">The name of the workbook including path from project folder. Used as the default for most programs.</td>
<td>data/test_wb.xlsx</td>
</tr>
<tr>
<td style="text-align: left;">start_year</td>
<td style="text-align: left;">Integer of 1st year to use for time series</td>
<td>2018</td>
</tr>
<tr>
<td style="text-align: left;">end_year</td>
<td style="text-align: left;">Last Year of the time series</td>
<td>2030</td>
</tr>
<tr>
<td style="text-align: left;">hide_years</td>
<td style="text-align: left;">List the years to hide on all sheets as numbers</td>
<td>2018</td>
</tr>
<tr>
<td style="text-align: left;">year_column_width</td>
<td style="text-align: left;">Column size for years</td>
<td>12</td>
</tr>
<tr>
<td style="text-align: left;">first_forecast_year</td>
<td style="text-align: left;">First year that is considered a forecast. Prior years are considered actual</td>
<td>2022</td>
</tr>
<tr>
<td style="text-align: left;">zoom_scale</td>
<td style="text-align: left;">Scaling factor for all sheets</td>
<td>135 # how to scale the worksheets</td>
</tr>
<tr>
<td style="text-align: left;">bank_interest</td>
<td style="text-align: left;">Moneydance category used to convey bank interest to the account balances</td>
<td>Income:I:Invest income:Int:Bank</td>
</tr>
<tr>
<td style="text-align: left;">lambdas</td>
<td style="text-align: left;">Excel lambda functions are defined here</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span id="__codeline-1-1"><span class="nt">lambdas</span><span class="p">:</span>
</span><span id="__codeline-1-2"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AGE</span>
</span><span id="__codeline-1-3"><span class="w">    </span><span class="nt">formula</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=LAMBDA(inits,yr,ROUNDDOWN(((DATE(yr,12,31)-DOB(inits))/365.25),0))</span>
</span><span id="__codeline-1-4"><span class="w">    </span><span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Return the age attained by an account owner with inits in a given year</span>
</span></code></pre></div>
<h3 id="sheet-groups">Sheet groups</h3>
<p>Sheets are grouped together in sheet groups using the <code>sheet_group</code> definitions.  Each sheet is assigned to a group and thus shares the color and table style.</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-2-1"><span class="nt">sheet_groups</span><span class="p">:</span>
</span><span id="__codeline-2-2"><span class="w">  </span><span class="nt">acct-bal</span><span class="p">:</span>
</span><span id="__codeline-2-3"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4FA3DB</span>
</span><span id="__codeline-2-4"><span class="w">    </span><span class="nt">table_style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TableStyleMedium2</span>
</span><span id="__codeline-2-5"><span class="w">  </span><span class="nt">income-expense</span><span class="p">:</span>
</span><span id="__codeline-2-6"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDAE2D</span>
</span><span id="__codeline-2-7"><span class="w">    </span><span class="nt">table_style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TableStyleMedium12</span>
</span><span id="__codeline-2-8"><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span></code></pre></div>
<h3 id="sheets">Sheets</h3>
<p>This section defines the layout and sometimes the data to be loaded into the sheet. It is a list of definition of each sheet.  So at that level it looks like:</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-3-1"><span class="nt">sheets</span><span class="p">:</span>
</span><span id="__codeline-3-2"><span class="w">  </span><span class="nt">accounts</span><span class="p">:</span>
</span><span id="__codeline-3-3"><span class="w">  </span><span class="nt">balances</span><span class="p">:</span>
</span><span id="__codeline-3-4"><span class="w">  </span><span class="nt">iande</span><span class="p">:</span>
</span><span id="__codeline-3-5"><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span></code></pre></div>
<h3 id="table-definitions">Table Definitions</h3>
<p>Within each sheet are the list of tables. Most sheets only have one.  Here's an example with two:</p>
<p><div class="highlight"><pre><span></span><code><span id="__codeline-4-1"><span class="nt">retireparms</span><span class="p">:</span>
</span><span id="__codeline-4-2"><span class="w">  </span><span class="nt">sheet_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">retirement</span>
</span><span id="__codeline-4-3"><span class="w">  </span><span class="nt">tables</span><span class="p">:</span>
</span><span id="__codeline-4-4"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tbl_retire_parms</span>
</span><span id="__codeline-4-5"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tbl_pens_facts</span>
</span></code></pre></div>
By convention all the table names start with <code>tbl_</code>.</p>
<p>The table definition consists of various fields, some of which are optional and/or defaulted.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Item</th>
<th style="text-align: left;">Purpose</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>name</strong></td>
<td style="text-align: left;">The name for the table in Excel, by convention starting with tbl_</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;"><strong>title</strong></td>
<td style="text-align: left;">The title that is place above the table in Excel</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;"><strong>columns</strong></td>
<td style="text-align: left;">A list of the column definitions (see <a href="#column-definitions">below</a>) that are included in the table</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">title_row</td>
<td style="text-align: left;">When there is more than one table, locates this table on the sheet. If tables are spread horizontally, then subsequent tables will need an entry.</td>
<td>1 for the first table, then automatically places a space before the next table.</td>
</tr>
<tr>
<td style="text-align: left;">start_col</td>
<td style="text-align: left;">The first column of the table on the sheet (A=1,B=2...)</td>
<td>1</td>
</tr>
<tr>
<td style="text-align: left;">include_years</td>
<td style="text-align: left;">True if there is a time series for the years</td>
<td>False</td>
</tr>
<tr>
<td style="text-align: left;">hidden</td>
<td style="text-align: left;">A list of columns to hide</td>
<td>Show every column</td>
</tr>
<tr>
<td style="text-align: left;">data</td>
<td style="text-align: left;">definitions where to get the data for the initial load</td>
<td>Don't load data</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#actual-and-forecast-formulas">actl_formulas</a></td>
<td style="text-align: left;">Specify formulas for actuals.</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#actual-and-forecast-formulas">fcst_formulas</a></td>
<td style="text-align: left;">Specify formulas for forecast periods.</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">highlights</td>
<td style="text-align: left;">Specify Excel conditional formatting</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#build-time-created-fields">dyno_fields</a></td>
<td style="text-align: left;">a way to determine values at build time</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#edit-checks">edit_checks</a></td>
<td style="text-align: left;">Sets data validation in Excel for table columns</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">preserve</td>
<td style="text-align: left;">Indicates what from a table to be "preserved" and how (only method "sparse" implemented). non-year-cols lists any columns other than forecast years to be preserved.</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">fold_at</td>
<td style="text-align: left;">For tables that fold, an integer indicating the level at which to leave the fold closed.</td>
<td>3</td>
</tr>
</tbody>
</table>
<h4 id="column-definitions">Column definitions</h4>
<p>The following support column definitions</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Item</th>
<th style="text-align: left;">Purpose</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">the column heading</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">width</td>
<td style="text-align: left;">optional width used to set column width in spreadsheet</td>
<td>width of previous column</td>
</tr>
<tr>
<td style="text-align: left;">horiz</td>
<td style="text-align: left;">optional indicator of horizontal alignment such as "center"</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">number_format</td>
<td style="text-align: left;">number from <a href="https://openpyxl.readthedocs.io/en/stable/_modules/openpyxl/styles/numbers.html">openpyxl chart</a></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="data-definitions">Data definitions</h4>
<p>The data definitions are purpose built to support the target table, but there are some elements that are common.  Some data definitions are closely related, so, to prevent duplication, the yaml reference/override notation is used (&amp; and *).  </p>
<table>
<thead>
<tr>
<th style="text-align: left;">Item</th>
<th style="text-align: left;">Purpose</th>
<th>Use context</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">source</td>
<td style="text-align: left;">local to reference local files; remote to pull data over internet. remote to pull data over internet. internal is used to create the table/sheet cross reference.</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">These codes are used by the program select the processing logic to use. <a href="#supported-types">See supported types</a></td>
<td>local</td>
</tr>
<tr>
<td style="text-align: left;">path</td>
<td style="text-align: left;">path relative to project folder</td>
<td>for local sources, the path and name of the primary input file</td>
</tr>
<tr>
<td style="text-align: left;">file_sets</td>
<td style="text-align: left;">for items that require additional files, one or more sets of files are defined. Each file set has a name and a value of the base_path which is a folder name with the trailing slash. Valid names are "balances" and "performance"</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">group</td>
<td style="text-align: left;">Specific Moneydance groupings to include. Moneydance uses these to categorize accounts.  Its things like: Assets, Bank Accounts, Credit Cards...</td>
<td>Accounts, Balances</td>
</tr>
<tr>
<td style="text-align: left;">no_details_for</td>
<td style="text-align: left;">For these groupings create rows only at the grouping level, no details. Investments here means to summarize to the investment level and don't carry over the securities.</td>
<td>Accounts</td>
</tr>
<tr>
<td style="text-align: left;">include_zeros</td>
<td style="text-align: left;">Accounts listed here will be carried over even if the balance is zero</td>
<td>Accounts</td>
</tr>
<tr>
<td style="text-align: left;">tax_free_keys</td>
<td style="text-align: left;">Mark the accounts that are not subject to current income tax</td>
<td>Accounts</td>
</tr>
<tr>
<td style="text-align: left;">site_code</td>
<td style="text-align: left;">BLS, or FEDREG. Used to determine which site to reference</td>
<td>remote</td>
</tr>
<tr>
<td style="text-align: left;">api_key</td>
<td style="text-align: left;">If needed. A reference to the api_key which is stored in ./private/api_keys.yml</td>
<td>remote</td>
</tr>
<tr>
<td style="text-align: left;">table</td>
<td style="text-align: left;">Defines how to locate a table in HTML</td>
<td>remote</td>
</tr>
<tr>
<td style="text-align: left;">table.find_method</td>
<td style="text-align: left;">caption - only supported method</td>
<td>remote</td>
</tr>
<tr>
<td style="text-align: left;">table.method_parameters</td>
<td style="text-align: left;">parameters for the method, specifically the text to search for in the caption.</td>
<td>remote</td>
</tr>
<tr>
<td style="text-align: left;">hier_separator</td>
<td style="text-align: left;">Typically set to colon.  The existence of this key indicates that the lines should be subtotaled and folded</td>
<td>iande,current,aux</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#inserting-rows-for-future-use">hier_insert_paths</a></td>
<td style="text-align: left;">Some line items are do not yet exist or are not yet populated in Moneydance. This is a way to insert them within the hierarchy so they can be used for forecasting.</td>
<td>iande,current,aux</td>
</tr>
<tr>
<td style="text-align: left;">hier_alt_agg</td>
<td style="text-align: left;">This optional field allows aggregation to occur by any of the following methods: MIN, MAX, PRODUCT. The default is TOTAL. This is a mapping between lines and one of the aggregation types.</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">template</td>
<td style="text-align: left;">Used in the cases where a template is used to generate the table. For the extract operation, this specifies the fields which are to be pulled from the table.  In the case of folding, it specifies the field to fold on and the indent depth</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="supported-types">Supported Types</h5>
<p>The types <code>json_index, json_records, *_template</code> are supported by the extract utility, so the values can be edited in Excel and saved off to be used in the next build. For the templates, additional definition is provided in the <code>setup.yaml</code> config file.</p>
<p>The types <code>md_*</code> act on exported Moneydance files.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">json_index</td>
<td style="text-align: left;">Imports entire table. Suitable when the table has a unique key.</td>
</tr>
<tr>
<td style="text-align: left;">json_records</td>
<td style="text-align: left;">Imports entire table. Suitable when the table does not have a unique key.</td>
</tr>
<tr>
<td style="text-align: left;">md_529_distr</td>
<td style="text-align: left;">Get the 529 plan distribution records from Moneydance export and summarize so data items can be put in spreadsheet</td>
</tr>
<tr>
<td style="text-align: left;">md_acct</td>
<td style="text-align: left;">Processes the latest balances report from Moneydance to set up the accounts table</td>
</tr>
<tr>
<td style="text-align: left;">md_bal</td>
<td style="text-align: left;">Processes the balances reports from Moneydance to set up the balances table</td>
</tr>
<tr>
<td style="text-align: left;">md_hsa_disb</td>
<td style="text-align: left;">Get the HSA disbursement records from Moneydance export and summarize so data items can be put in spreadsheet</td>
</tr>
<tr>
<td style="text-align: left;">md_iande_actl</td>
<td style="text-align: left;">Processes the income and expense report from Moneydance to create the iande and current sheets</td>
</tr>
<tr>
<td style="text-align: left;">md_invest_actl</td>
<td style="text-align: left;">Sets up the investment actual transfers</td>
</tr>
<tr>
<td style="text-align: left;">md_invest_iande_work</td>
<td style="text-align: left;">Read investment income and expense actual data from file into a dataframe</td>
</tr>
<tr>
<td style="text-align: left;">md_ira_distr</td>
<td style="text-align: left;">Get the IRA distribution records from Moneydance export and summarize so data items can be put in spreadsheet</td>
</tr>
<tr>
<td style="text-align: left;">md_pr_sav</td>
<td style="text-align: left;">Get the payroll to savings records from Moneydance export and summarize so data items can be put in spreadsheet</td>
</tr>
<tr>
<td style="text-align: left;">md_roth</td>
<td style="text-align: left;">Get the roth contributions</td>
</tr>
<tr>
<td style="text-align: left;">md_sel_inv</td>
<td style="text-align: left;">Get amounts transferred to/from certain brokerages, mutual funds, loans from/to any banks.</td>
</tr>
<tr>
<td style="text-align: left;">md_transfers_actl</td>
<td style="text-align: left;">Sets up the non-investment actual transfers</td>
</tr>
<tr>
<td style="text-align: left;">retire_medical_template</td>
<td style="text-align: left;">Sets up the retire medical table based on a template</td>
</tr>
<tr>
<td style="text-align: left;">retire_template</td>
<td style="text-align: left;">Set up the retirement table based on a template</td>
</tr>
<tr>
<td style="text-align: left;">tax_template</td>
<td style="text-align: left;">Prepares the taxes worksheet based on a template</td>
</tr>
</tbody>
</table>
<h5 id="inserting-rows">Inserting Rows</h5>
<p>An optional key is used to define new rows to be inserted on sheets that use the folding/subtotaling method.</p>
<p>For instance, the income and expense report in MoneyDance filters out categories that have no transactions.  This leads to a need to insert those rows in the <code>tbl_iande</code> and <code>tbl_iande_actl</code> tables. For example, future social security payouts should subtotal into retirement income. </p>
<p>It is also useful in the aux table to construct subtotals.</p>
<p>The specification of the new rows needs to contain the full hiearchy information so that it can be inserted into the right place.  At run time these are checked against the existing items and added only if not already there.</p>
<p>Note: include only those lines that are not headings or totals. Headings and total lines will be constructed and inserted as well as the specified data lines.</p>
<p>In this example, we aggregate based on the MIN function to plan the distributions from the health savings accounts</p>
<p><img alt="alt_agg" src="../images/tgt/alt_agg.png" /></p>
<h4 id="actual-and-forecast-formulas">Actual and Forecast Formulas</h4>
<p>There are three optional keys to allow formulas to be established for the years section: <code>actl_formulas</code>, <code>all_col_formulas</code>, and <code>fcst_formulas</code>.  They work the same way but apply to different columns, as their names indicate.</p>
<p>Each section consists of a list of rules.  All rules have the following parts:</p>
<table>
<thead>
<tr>
<th>Key word</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>formula</td>
<td>The formula to use for the selected year columns (actual or forecast)</td>
</tr>
<tr>
<td>first_item</td>
<td>Optional. In some cases the first item or items of the series needs to be different. If supplied it may be a keyword <code>skip</code>. If it starts with <code>=</code> then it is a formula that will be used in the first place. Otherwise, it will be a constant or a list of constants separated by <code>,</code>. In that case it will be applied to the first <em>n</em> positions.</td>
</tr>
</tbody>
</table>
<p>There are two constructions.  The first is the enumeration method, where the config lists all the keys that are to be matched against a base field.</p>
<table>
<thead>
<tr>
<th>Key word</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>base_field</td>
<td>The name of the column that is used for matching</td>
</tr>
<tr>
<td>matches</td>
<td>A list of values by which to match rows. This could match a single row or many rows.</td>
</tr>
</tbody>
</table>
<p>The second construction allows for queries against several fields.  These are "anded" together to product a boolean series to select the rows to be updated.</p>
<table>
<thead>
<tr>
<th>Key word</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>The query is a list of objects with the following fields.</td>
</tr>
<tr>
<td>- field</td>
<td>A field name in this table</td>
</tr>
<tr>
<td>- compare_to</td>
<td>A value to compare to, either a string or a number</td>
</tr>
<tr>
<td>- compare_with</td>
<td>A comparison like "=", starts, not_starting, is_in. YAML requires the equals to be quoted. If is_in is used, there should be a list</td>
</tr>
<tr>
<td>- look_up</td>
<td>Allows for the values to be looked up from another table. It requires three addtional subfields: table, index_on and value_field.</td>
</tr>
</tbody>
</table>
<p>For example, if there is a key <code>fcst_formulas</code> under the table, it is used to set formulas for the forecast columns.  Each column receives the same formula, but they can vary by row.  </p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-5-1"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="c1">#  Mkt Gn Rate</span>
</span><span id="__codeline-5-2"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ValType</span>
</span><span id="__codeline-5-3"><span class="w">      </span><span class="nt">compare_with</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;=&quot;</span>
</span><span id="__codeline-5-4"><span class="w">      </span><span class="nt">compare_to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mkt Gn Rate</span>
</span><span id="__codeline-5-5"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Type</span>
</span><span id="__codeline-5-6"><span class="w">      </span><span class="nt">compare_with</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;=&quot;</span>
</span><span id="__codeline-5-7"><span class="w">      </span><span class="nt">compare_to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">I</span>
</span><span id="__codeline-5-8"><span class="w">      </span><span class="nt">look_up</span><span class="p">:</span><span class="w"> </span>
</span><span id="__codeline-5-9"><span class="w">        </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tbl_accounts</span>
</span><span id="__codeline-5-10"><span class="w">        </span><span class="nt">index_on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AcctName</span>
</span><span id="__codeline-5-11"><span class="w">        </span><span class="nt">value_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Type</span>
</span><span id="__codeline-5-12"><span class="w">    </span><span class="nt">first_item</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=XLOOKUP([@AcctName],tbl_accounts[Account],tbl_accounts[Near Mkt Rate],0)*[@Active]</span>
</span><span id="__codeline-5-13"><span class="w">    </span><span class="nt">formula</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=XLOOKUP([@AcctName]&amp;&quot;:Unrlz Gn/Ls&quot;,tbl_invest_iande_ratios[Key],tbl_invest_iande_ratios[Y1234])</span>
</span><span id="__codeline-5-14"><span class="w w-Error"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span></code></pre></div>
<p>How to use the look_up function</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-6-1"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="c1"># Bank actual interest</span>
</span><span id="__codeline-6-2"><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ValType</span><span class="w"> </span>
</span><span id="__codeline-6-3"><span class="w">              </span><span class="nt">compare_with</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;=&quot;</span>
</span><span id="__codeline-6-4"><span class="w">              </span><span class="nt">compare_to</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Rlz</span><span class="nv"> </span><span class="s">Int/Gn&quot;</span>
</span><span id="__codeline-6-5"><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Type</span>
</span><span id="__codeline-6-6"><span class="w">              </span><span class="nt">compare_with</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;=&quot;</span>
</span><span id="__codeline-6-7"><span class="w">              </span><span class="nt">compare_to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B</span><span class="w"> </span>
</span><span id="__codeline-6-8"><span class="w">              </span><span class="nt">look_up</span><span class="p">:</span><span class="w"> </span>
</span><span id="__codeline-6-9"><span class="w">                </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tbl_accounts</span>
</span><span id="__codeline-6-10"><span class="w">                </span><span class="nt">index_on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AcctName</span>
</span><span id="__codeline-6-11"><span class="w">                </span><span class="nt">value_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Type</span>
</span></code></pre></div>
<p>Using the <code>is_in</code> comparator:</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-7-1">          - query: # Add/Wdraw - Assets, Liabilities &amp; Loans
</span><span id="__codeline-7-2">            - field: ValType
</span><span id="__codeline-7-3">              compare_with: &quot;=&quot;
</span><span id="__codeline-7-4">              compare_to: Add/Wdraw          
</span><span id="__codeline-7-5">            - field: Type
</span><span id="__codeline-7-6">              compare_with: is_in
</span><span id="__codeline-7-7">              compare_to:
</span><span id="__codeline-7-8">              - A
</span><span id="__codeline-7-9">              - L
</span><span id="__codeline-7-10">              - N
</span><span id="__codeline-7-11">              look_up: 
</span><span id="__codeline-7-12">                table: tbl_accounts
</span><span id="__codeline-7-13">                index_on: AcctName
</span><span id="__codeline-7-14">                value_field: Type
</span></code></pre></div>
<h5 id="array-formulas">Array formulas</h5>
<p>It is not possible to use dynamic arrays fully as they are not well supported (yet?) by <code>openpyxl</code>. However, some effort has been made to allow for control-shift-enter (CSE) arrays. These work best when the formula summarizes to a single cell or results in a single column of results in a fixed size array.  This has been tested for use with data validation.</p>
<p>For instance the following formula selects the active accounts with no distribution plan which is used for data validation of a table field.</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-8-1">=SORT(FILTER(tbl_accounts[Account],(tbl_accounts[Active]=1)*(tbl_accounts[No Distr Plan]=1)))
</span></code></pre></div>
<p>The result is stored under a heading of CHOICES.  The data validation is a list with a source of <code>=$F$3#</code>.  The # indicates the entire result set.</p>
<p><img alt="image" src="../images/tgt/data_validation.png" /></p>
<p>The following formula (shown wrapped) uses dynamic array functions, but due to the <code>openpyxl</code> limitation it results in a CSE formula, which is fine since it produces a single value.</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-9-1">=SUM(
</span><span id="__codeline-9-2">  BYROW(
</span><span id="__codeline-9-3">    (tbl_transfers_plan[[From_Account]:[To_Account]]=tbl_balances[@AcctName])*HSTACK(-tbl_transfers_plan[Amount],tbl_transfers_plan[Amount]),
</span><span id="__codeline-9-4">    LAMBDA(_xlpm.row,SUM(_xlpm.row))
</span><span id="__codeline-9-5">  )
</span><span id="__codeline-9-6">  *(tbl_transfers_plan[Y_Year]=this_col_name()))
</span></code></pre></div>
<p>The lambda function needs its parameters prefixed with _xlpm.  The code handles the prefixes for the dynamic array functions.</p>
<p>After an Excel session when the file is saved, Excel will rewrite the document so that the internal XML files have new schemas listed.  Further, if a CSE formula is edited, it may be converted to a dynamic array formula, and, in that case, an internal <code>metadata.xml</code> file is created to support the dynamic arrays.  If <code>openpyxl</code> later rewrites the file, the <code>metadata.xml</code> and the references to it in the dynamic array formulas will be lost.  This has the effect of converting back to a CSE formula.</p>
<h4 id="build-time-created-fields">Build-time created fields</h4>
<p>Some tables need a way to determine values at build time. The <code>dyno_fields</code> section may be directly under the table.</p>
<p><img alt="dyno_fields" src="../images/tgt/dyno_field.png" /></p>
<p>the <code>matches</code> list is a list of values to be matched agains the field. There is a special case if just a single *, meaning all.</p>
<p>The target field should be previously defined, but it is filled in by this logic.  The commands available are:
- suffix - something added to the matched item
- constant - a value that is always the same
- formula - an Excel formula</p>
<h5 id="formula-specifics">Formula Specifics</h5>
<ul>
<li>Always start the formula with a leading equals sign.</li>
<li>Constants are fine, but remember to use the leading equals sign</li>
<li>Structured table references are supported and recommended.  </li>
<li>Refer to this column with the VBA function <code>this_col_name()</code></li>
<li>Many VBA functions are designed to be used in formulas</li>
</ul>
<h4 id="highlights">Highlights</h4>
<p>For example the following puts a line between the actual and forecast periods. The anchor, (ampersand) allows other tables to use the same by using <code>*past_future</code>. </p>
<div class="highlight"><pre><span></span><code><span id="__codeline-10-1"><span class="w">    </span><span class="nt">highlights</span><span class="p">:</span><span class="w"> </span>
</span><span id="__codeline-10-2"><span class="w">      </span><span class="nt">present</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;past_future</span>
</span><span id="__codeline-10-3"><span class="w">        </span><span class="nt">formula</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=A$2=&quot;Y&quot;&amp;YEAR(NOW())</span><span class="w"> </span><span class="c1"># ref is to heading row</span>
</span><span id="__codeline-10-4"><span class="w">        </span><span class="nt">border</span><span class="p">:</span>
</span><span id="__codeline-10-5"><span class="w">          </span><span class="nt">edges</span><span class="p">:</span><span class="w"> </span>
</span><span id="__codeline-10-6"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">left</span>
</span><span id="__codeline-10-7"><span class="w">          </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">thin</span>
</span><span id="__codeline-10-8"><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B50000</span>
</span></code></pre></div>
<h4 id="edit-checks">Edit Checks</h4>
<p>This provides a way to use a dynamic array filter in Excel to create a data validation list (a drop down menu) for a set of columns.</p>
<p><div class="highlight"><pre><span></span><code><span id="__codeline-11-1"><span class="w">      </span><span class="nt">edit_checks</span><span class="p">:</span>
</span><span id="__codeline-11-2"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">for_columns</span><span class="p">:</span>
</span><span id="__codeline-11-3"><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">From_Account</span>
</span><span id="__codeline-11-4"><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">To_Account</span>
</span><span id="__codeline-11-5"><span class="w">          </span><span class="nt">formula</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=SORT(FILTER(tbl_accounts[Account],(tbl_accounts[Active]=1)*(tbl_accounts[No Distr Plan]=1)))</span><span class="w">          </span>
</span></code></pre></div>
The formula will be placed to the right of the table and the a data validation will reference it for each of the columns.  In this example the active accounts with no distribution plan will be displayed as the drop down choices for the to listed columns.</p>
<h3 id="specific-sheets-tables">Specific Sheets &amp; Tables</h3>
<h4 id="inflation">Inflation</h4>
<p>You may want to consider a different series.  The default is all items in U.S. city average, all urban consumers, not seasonally adjusted.</p>
<h4 id="required-minimum-distributions">Required minimum distributions</h4>
<p>At the time of writing the best source seems to be the Federal Register.  This does not need to edited unless the source changes.  </p>
<h4 id="accounts">Accounts</h4>
<p>The data section in the <code>setup.yaml</code> needs the following sub-sections:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Item</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">path</td>
<td style="text-align: left;">Path from the project root where to find the saved report`.  This should be one with all the accounts you wish to use.</td>
</tr>
<tr>
<td style="text-align: left;">group</td>
<td style="text-align: left;">this is a list of the summary levels you wish to use in your plan.  The items can either be the categories that Moneydance uses such as Bank Accounts, or it can be summary accounts that you have created (accounts that have sub-accounts)</td>
</tr>
<tr>
<td style="text-align: left;">no_details_for</td>
<td style="text-align: left;">If you have summary accounts that cover all the items in a category, then you can use those instead of the leaf accounts. By listing the category hear the detail accounts will be ignored.</td>
</tr>
<tr>
<td style="text-align: left;">include_zeros</td>
<td style="text-align: left;">Usually zero balance accounts will be ignored.  If the account is entered here, it will be carried forward.  This can be useful if its a brand new account with no balance or if its an old account that had a balance in the historical period.</td>
</tr>
<tr>
<td style="text-align: left;">tax_free_keys</td>
<td style="text-align: left;">A list of keywords that will be used to determine how the tax status of the account will be initialized.</td>
</tr>
<tr>
<td style="text-align: left;">force_active</td>
<td style="text-align: left;">A list of accounts to force active. By default accounts with zero balance are made inactive</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span id="__codeline-12-1"><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./data/2022 Account Balances.tsv</span>
</span><span id="__codeline-12-2"><span class="nt">group</span><span class="p">:</span>
</span><span id="__codeline-12-3"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bank Accounts</span>
</span><span id="__codeline-12-4"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Credit Cards</span>
</span><span id="__codeline-12-5"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Real Estate</span>
</span><span id="__codeline-12-6"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Other Asset</span>
</span><span id="__codeline-12-7"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Liabilities</span>
</span><span id="__codeline-12-8"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mortgage Loans</span>
</span><span id="__codeline-12-9"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Non Mort Loans</span>
</span><span id="__codeline-12-10"><span class="nt">no_details_for</span><span class="p">:</span>
</span><span id="__codeline-12-11"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Assets</span>
</span><span id="__codeline-12-12"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Loans</span>
</span><span id="__codeline-12-13"><span class="nt">include_zeros</span><span class="p">:</span>
</span><span id="__codeline-12-14"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">My old HSA</span>
</span><span id="__codeline-12-15"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">My old 401K</span>
</span><span id="__codeline-12-16"><span class="nt">tax_free_keys</span><span class="p">:</span>
</span><span id="__codeline-12-17"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">401K</span>
</span><span id="__codeline-12-18"><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;529&quot;</span>
</span><span id="__codeline-12-19"><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IRA</span>
</span></code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>