
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Setting up the spreadsheet - Budget Dance</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#setting-up-the-spreadsheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Budget Dance" class="md-header__button md-logo" aria-label="Budget Dance" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Budget Dance
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Setting up the spreadsheet
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Budget Dance" class="md-nav__button md-logo" aria-label="Budget Dance" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Budget Dance
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Tools to map accounting data to long term plans
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../data_from_moneydance/" class="md-nav__link">
        Data from Moneydance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fcast/" class="md-nav__link">
        Design of fcast.xlsm
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../report_configs/" class="md-nav__link">
        Report definitions
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Setting up the spreadsheet
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Setting up the spreadsheet
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps" class="md-nav__link">
    Summary of steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conventions" class="md-nav__link">
    Conventions
  </a>
  
    <nav class="md-nav" aria-label="Conventions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-types" class="md-nav__link">
    File types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-locations" class="md-nav__link">
    File locations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-names" class="md-nav__link">
    File names
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reports-and-their-files" class="md-nav__link">
    Reports and their files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-key" class="md-nav__link">
    API key
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-setup-control-file" class="md-nav__link">
    The setup control file
  </a>
  
    <nav class="md-nav" aria-label="The setup control file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#global-settings" class="md-nav__link">
    Global Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheet-groups" class="md-nav__link">
    Sheet groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheets" class="md-nav__link">
    Sheets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-definitions" class="md-nav__link">
    Table Definitions
  </a>
  
    <nav class="md-nav" aria-label="Table Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-definitions" class="md-nav__link">
    Data definitions
  </a>
  
    <nav class="md-nav" aria-label="Data definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-types" class="md-nav__link">
    Supported Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inserting-rows-for-future-use" class="md-nav__link">
    Inserting Rows for Future Use
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actual-and-forecast-formulas" class="md-nav__link">
    Actual and Forecast Formulas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-time-created-fields" class="md-nav__link">
    Build-time created fields
  </a>
  
    <nav class="md-nav" aria-label="Build-time created fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formula-specifics" class="md-nav__link">
    Formula Specifics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highlights" class="md-nav__link">
    Highlights
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specific-sheets-tables" class="md-nav__link">
    Specific Sheets &amp; Tables
  </a>
  
    <nav class="md-nav" aria-label="Specific Sheets &amp; Tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inflation" class="md-nav__link">
    Inflation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-minimum-distributions" class="md-nav__link">
    Required minimum distributions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accounts" class="md-nav__link">
    Accounts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vba_index/" class="md-nav__link">
        VBA Code Summary
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vba_sorted/" class="md-nav__link">
        VBA Code
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../worksheets/" class="md-nav__link">
        Worksheets
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps" class="md-nav__link">
    Summary of steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conventions" class="md-nav__link">
    Conventions
  </a>
  
    <nav class="md-nav" aria-label="Conventions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-types" class="md-nav__link">
    File types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-locations" class="md-nav__link">
    File locations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-names" class="md-nav__link">
    File names
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reports-and-their-files" class="md-nav__link">
    Reports and their files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-key" class="md-nav__link">
    API key
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-setup-control-file" class="md-nav__link">
    The setup control file
  </a>
  
    <nav class="md-nav" aria-label="The setup control file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#global-settings" class="md-nav__link">
    Global Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheet-groups" class="md-nav__link">
    Sheet groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sheets" class="md-nav__link">
    Sheets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-definitions" class="md-nav__link">
    Table Definitions
  </a>
  
    <nav class="md-nav" aria-label="Table Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-definitions" class="md-nav__link">
    Data definitions
  </a>
  
    <nav class="md-nav" aria-label="Data definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-types" class="md-nav__link">
    Supported Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inserting-rows-for-future-use" class="md-nav__link">
    Inserting Rows for Future Use
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actual-and-forecast-formulas" class="md-nav__link">
    Actual and Forecast Formulas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-time-created-fields" class="md-nav__link">
    Build-time created fields
  </a>
  
    <nav class="md-nav" aria-label="Build-time created fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formula-specifics" class="md-nav__link">
    Formula Specifics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highlights" class="md-nav__link">
    Highlights
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specific-sheets-tables" class="md-nav__link">
    Specific Sheets &amp; Tables
  </a>
  
    <nav class="md-nav" aria-label="Specific Sheets &amp; Tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inflation" class="md-nav__link">
    Inflation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-minimum-distributions" class="md-nav__link">
    Required minimum distributions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accounts" class="md-nav__link">
    Accounts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="setting-up-the-spreadsheet">Setting up the spreadsheet</h1>
<h2 id="summary-of-steps">Summary of steps</h2>
<ol>
<li>Save certain reports from Moneydance to the <code>data</code> folder.</li>
<li>Acquire a registration key for the bureau of labor statistics (for inflation data)</li>
<li>Edit the control file: <code>dance/setup/setup.yaml</code></li>
<li>Run <code>dance/setup/create_wb.py</code></li>
</ol>
<h2 id="conventions">Conventions</h2>
<h3 id="file-types">File types</h3>
<p>Set up files are either </p>
<ul>
<li>tab separated values with extension .tsv</li>
<li>JSON with extension .json.  These are typically exports from tables defined in Excel. There are two types depending on the 'orientation'.  </li>
<li>YAML - used for the setup config definitions</li>
</ul>
<h3 id="file-locations">File locations</h3>
<p>Files are in the data folder under the project.  The data folder is not included in the git repository. </p>
<p>To make more manageable, the files that have a version each year are placed in subfolders.  The under the sub-folder the files are simply named <em>yyyy</em>.tsv.</p>
<p>A listing of the files can be had with </p>
<p><code>tree -PD '*.tsv' --prune data/</code></p>
<h3 id="file-names">File names</h3>
<p>Preferred format uses hyphen not underscores or spaces to separate words. Abbreviations such as IRA and HSA are forced to lowercase, to aid sorting.</p>
<h2 id="reports-and-their-files">Reports and their files</h2>
<p>(Case sensitive sort to match Moneydance)</p>
<table>
<thead>
<tr>
<th align="left">Report</th>
<th align="left">Periods</th>
<th align="left">File(s)</th>
<th align="left">Used in config by</th>
<th align="left">Other file use</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">401, HSA, ESP payroll data</td>
<td align="left">full years</td>
<td align="left">payroll_to_savings.tsv</td>
<td align="left">tbl_payroll_savings</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">529-Distr[^4]</td>
<td align="left">all years</td>
<td align="left">529-distr.tsv</td>
<td align="left">tbl_529_distr</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Account Balances</td>
<td align="left">each year</td>
<td align="left">acct-bals-<em>yyyy</em>.tsv</td>
<td align="left">tbl_accounts[^1], tbl_balances[^2]</td>
<td align="left">bank_actl_load.py[^3]</td>
</tr>
<tr>
<td align="left">HSA - disbursements - 2</td>
<td align="left">full years</td>
<td align="left">hsa-disbursements.tsv</td>
<td align="left">tbl_hsa_disb[^5]</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">IRA-Distr[^6]</td>
<td align="left">all years</td>
<td align="left">ira-distr.tsv</td>
<td align="left">tbl_ira_distr</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Income &amp; Expense by Year</td>
<td align="left">full years</td>
<td align="left">iande.tsv</td>
<td align="left">tbl_iande,tbl_iande_actl</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Investment IandE[^7]</td>
<td align="left">full years</td>
<td align="left">invest-iande.tsv</td>
<td align="left">tbl_invest_iande_work</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Investment Performance</td>
<td align="left">each year</td>
<td align="left">invest-p-<em>yyyy</em>.tsv</td>
<td align="left">tbl_invest_actl[^7]</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Roth-contributions2</td>
<td align="left">all years</td>
<td align="left">roth_contributions.tsv</td>
<td align="left">tbl_roth_contributions</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Transfers BKG detailed</td>
<td align="left">full years</td>
<td align="left">trans_bkg.tsv</td>
<td align="left">tbl_bank_sel_invest[^10]</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Transfers to Investment Accounts by Year</td>
<td align="left">full years</td>
<td align="left">invest-x.tsv</td>
<td align="left">tbl_invest_actl</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Transfers-to-fcast[^9]</td>
<td align="left">full years</td>
<td align="left">transfers.tsv</td>
<td align="left">tbl_transfers_actl</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2 id="api-key">API key</h2>
<p>The system copies the inflation data to faciliatate planning.  To do this an API key is needed.  This is free they only want an email address.  Register here: <a href="https://data.bls.gov/registrationEngine/">https://data.bls.gov/registrationEngine/</a>.  The API key should be stored in ./private/api_keys.yml. The rows of this file are expected to be simply a site code and the key value, such as below:</p>
<pre><code class="language-yaml">bls: 7b50d7a727104578b1ac86bc27caff3f
</code></pre>
<h2 id="the-setup-control-file">The setup control file</h2>
<p>The control file is <code>dance/data/setup.yaml</code>.</p>
<h3 id="global-settings">Global Settings</h3>
<p>The following values are global in nature:</p>
<table>
<thead>
<tr>
<th align="left">Item</th>
<th align="left">Purpose</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">start_year</td>
<td align="left">Integer of 1st year to use for time series</td>
<td>2018</td>
</tr>
<tr>
<td align="left">end_year</td>
<td align="left">Last Year of the time series</td>
<td>2030</td>
</tr>
<tr>
<td align="left">year_column_width</td>
<td align="left">Column size for years</td>
<td>12</td>
</tr>
<tr>
<td align="left">first_forecast_year</td>
<td align="left">First year that is considered a forecast. Prior years are considered actual</td>
<td>2022</td>
</tr>
<tr>
<td align="left">zoom_scale</td>
<td align="left">Scaling factor for all sheets</td>
<td>135 # how to scale the worksheets</td>
</tr>
<tr>
<td align="left">bank_interest</td>
<td align="left">Moneydance category used to convey bank interest to the account balances</td>
<td>Income:I:Invest income:Int:Bank</td>
</tr>
</tbody>
</table>
<h3 id="sheet-groups">Sheet groups</h3>
<p>Sheets are grouped together in sheet groups using the <code>sheet_group</code> definitions.  Each sheet is assigned to a group and thus shares the color and table style.</p>
<h3 id="sheets">Sheets</h3>
<p>This section defines the layout and sometimes the data to be loaded into the sheet. It is a list of definition of each sheet.  So at that level it looks like:</p>
<pre><code class="language-yaml">sheets:
  accounts:
  balances:
  iande:
  ...
</code></pre>
<h3 id="table-definitions">Table Definitions</h3>
<p>Within each sheet are the list of tables. Most sheets only have one.  Here's an example with two:</p>
<pre><code class="language-yaml">retireparms:
  sheet_group: retirement
  tables:
  - name: tbl_retire_parms
  - name: tbl_pens_facts
</code></pre>
<p>By convention all the table names start with <code>tbl_</code>.</p>
<p>The table definition consists of various fields, some of which are optional and/or defaulted.</p>
<table>
<thead>
<tr>
<th align="left">Item</th>
<th align="left">Purpose</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>title</strong></td>
<td align="left">The title that is place above the table in Excel</td>
<td></td>
</tr>
<tr>
<td align="left"><strong>columns</strong></td>
<td align="left">A list of the column definitions (name and width) that are included before the time</td>
<td></td>
</tr>
<tr>
<td align="left">title_row</td>
<td align="left">When there is more than one table, locates this table on the sheet. If tables are spread horizontally, then subsequent tables will need an entry.</td>
<td>1 for the first table, then automatically places a space before the next table.</td>
</tr>
<tr>
<td align="left">start_col</td>
<td align="left">The first column of the table on the sheet (A=1,B=2...)</td>
<td>1</td>
</tr>
<tr>
<td align="left">include_years</td>
<td align="left">True if there is a time series for the years</td>
<td>False</td>
</tr>
<tr>
<td align="left">hidden</td>
<td align="left">A list of columns to hide</td>
<td>Show every column</td>
</tr>
<tr>
<td align="left">data</td>
<td align="left">definitions where to get the data for the initial load</td>
<td>Don't load data</td>
</tr>
<tr>
<td align="left"><a href="#actual-and-forecast-formulas">actl_formulas</a></td>
<td align="left">Specify formulas for actuals.</td>
<td></td>
</tr>
<tr>
<td align="left"><a href="#actual-and-forecast-formulas">fcst_formulas</a></td>
<td align="left">Specify formulas for forecast periods.</td>
<td></td>
</tr>
<tr>
<td align="left">highlights</td>
<td align="left">Specify Excel conditional formatting</td>
<td></td>
</tr>
<tr>
<td align="left"><a href="#build-time-created-fields">dyno_fields</a></td>
<td align="left">a way to determine values at build time</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="data-definitions">Data definitions</h4>
<p>The data definitions are purpose built to support the target table, but there are some elements that are common.  Some data definitions are closely related, so, to prevent duplication, the yaml reference/override notation is used (&amp; and *).  </p>
<table>
<thead>
<tr>
<th align="left">Item</th>
<th align="left">Purpose</th>
<th>Use context</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">source</td>
<td align="left">local to reference local files; remote to pull data over internet. remote to pull data over internet. internal is used to create the table/sheet cross reference.</td>
<td></td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">These codes are used by the program select the processing logic to use. <a href="#supported-types">See supported types</a></td>
<td>local</td>
</tr>
<tr>
<td align="left">path</td>
<td align="left">path relative to project folder</td>
<td>for local sources, the path and name of the primary input file</td>
</tr>
<tr>
<td align="left">file_sets</td>
<td align="left">for items that require additional files, one or more sets of files are defined. Each file set has a name and a value of the base_path which is a folder name with the trailing slash. Valid names are "balances" and "performance"</td>
<td></td>
</tr>
<tr>
<td align="left">group</td>
<td align="left">Specific Moneydance groupings to include. Moneydance uses these to categorize accounts.  Its things like: Assets, Bank Accounts, Credit Cards...</td>
<td>Accounts, Balances</td>
</tr>
<tr>
<td align="left">no_details_for</td>
<td align="left">For these groupings create rows only at the grouping level, no details. Investments here means to summarize to the investment level and don't carry over the securities.</td>
<td>Accounts</td>
</tr>
<tr>
<td align="left">include_zeros</td>
<td align="left">Accounts listed here will be carried over even if the balance is zero</td>
<td>Accounts</td>
</tr>
<tr>
<td align="left">tax_free_keys</td>
<td align="left">Mark the accounts that are not subject to current income tax</td>
<td>Accounts</td>
</tr>
<tr>
<td align="left">site_code</td>
<td align="left">BLS, or FEDREG. Used to determine which site to reference</td>
<td>remote</td>
</tr>
<tr>
<td align="left">api_key</td>
<td align="left">If needed. A reference to the api_key which is stored in ./private/api_keys.yml</td>
<td>remote</td>
</tr>
<tr>
<td align="left">table</td>
<td align="left">Defines how to locate a table in HTML</td>
<td>remote</td>
</tr>
<tr>
<td align="left">table.find_method</td>
<td align="left">caption - only supported method</td>
<td>remote</td>
</tr>
<tr>
<td align="left">table.method_parameters</td>
<td align="left">parameters for the method, specifically the text to search for in the caption.</td>
<td>remote</td>
</tr>
<tr>
<td align="left"><a href="#inserting-rows-for-future-use">hier_insert_paths</a></td>
<td align="left">Some line items are do not yet exist or are not yet populated in Moneydance. This is a way to insert them within the hierarchy so they can be used for forecasting.</td>
<td>iande</td>
</tr>
</tbody>
</table>
<h5 id="supported-types">Supported Types</h5>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">md_acct</td>
<td align="left">Processes the account extract from Moneydance</td>
</tr>
<tr>
<td align="left">md_bal</td>
<td align="left">Processes the balances extract from Moneydance</td>
</tr>
<tr>
<td align="left">md_iande_actl</td>
<td align="left">Processes the income and expense extract from Moneydance to create the iande and iande_actl sheets</td>
</tr>
<tr>
<td align="left">md_transfers_actl</td>
<td align="left">Sets up the non-investment actual transfers</td>
</tr>
<tr>
<td align="left">md_invest_actl</td>
<td align="left">Sets up the investment actual transfers</td>
</tr>
<tr>
<td align="left">json_index</td>
<td align="left">Imports entire table previously exported via <code>dance/util/extract_table.py</code> using the <code>-o index</code> option. Suitable when the table has a unique key.</td>
</tr>
<tr>
<td align="left">json_records</td>
<td align="left">Imports entire table previously exported via <code>dance/util/extract_table.py</code> using the <code>-o index</code> option. Suitable when the table does not have a unique key.</td>
</tr>
<tr>
<td align="left">tax_template</td>
<td align="left">Prepares the taxes worksheet</td>
</tr>
</tbody>
</table>
<h5 id="inserting-rows-for-future-use">Inserting Rows for Future Use</h5>
<p>The income and expense report in MoneyDance filters out categories that have no transactions.  This leads to a need to insert those rows in the <code>tbl_iande</code> and <code>tbl_iande_actl</code> tables. For example, future social security payouts should subtotal into retirement income. </p>
<p>An optional key is used to define these rows. The specification needs to contain the full hiearchy information so that it can be inserted into the right place.  At run time these are checked against the existing items and added only if not already there.</p>
<pre><code class="language-yaml">data: ...
  hier_insert_paths:
    - Income: &quot;Income:I:Retirement income:Social Security:SS-G&quot;
    - Income: &quot;Income:I:Retirement income:Social Security:SS-V&quot;
</code></pre>
<p>Include only those lines that are not headings or totals; those will be constructed and inserted as well as the specified data lines.</p>
<h4 id="actual-and-forecast-formulas">Actual and Forecast Formulas</h4>
<p>There are two optional keys to allow formulas to be established for the years section: <code>actl_formulas</code> and <code>fcst_formulas</code>.  They work the same way but apply to different columns. </p>
<p>Each section consists of a list of rules.  The rules have the following parts:
|Key word|Description|
|---|---|
|base_field|The name of the column that is used for matching|
|matches|A list of values by which to match rows. This could match a single row or many rows.|
|formula|The formula to use for the selected year columns (actual or forecast)
|first_item|Optional. In some cases the first item or items of the series needs to be different. If supplied it may be a keyword <code>skip</code>. If it starts with <code>=</code> then it is a formula that will be used in the first place. Otherwise, it will be a constant or a list of constants separated by <code>,</code>. In that case it will be applied to the first <em>n</em> positions.|</p>
<p>For example, if there is a key <code>fcst_formulas</code> under the table, it is used to set formulas for the forecast columns.  Each column receives the same formula, but they can vary by row.  The structure is setup like this:</p>
<pre><code class="language-yaml">fcst_formulas:
  - base_field: ValType
    matches:
    - Rate
    formula: =.03
  - base_field: ValType
    matches:
    - Add/Wdraw
    formula: =add_wdraw( [@AcctName],this_col_name())
  - base_field: ...
</code></pre>
<h4 id="build-time-created-fields">Build-time created fields</h4>
<p>Some tables need a way to determine values at build time. The <code>dyno_fields</code> section may be directly under the table.</p>
<pre><code class="language-yaml">dyno_fields:
  - base_field: Account
    matches:
      - 401K - GBD - TRV
      - CHET - Fidelity
    actions:
      - target_field: Fcst_source
        suffix: &quot;- wdraw&quot;
      - target_field: Fcst_source_tab
        constant: tbl_aux
  - base_field: ...
</code></pre>
<p>the <code>matches</code> list is a list of values to be matched agains the field. There is a special case if just a single *, meaning all.</p>
<p>The target field should be previously defined, but it is filled in by this logic.  The commands available are:
- suffix - something added to the matched item
- constant - a value that is always the same
- formula - an Excel formula</p>
<h5 id="formula-specifics">Formula Specifics</h5>
<ul>
<li>Always start the formula with a leading equals sign.</li>
<li>Constants are fine, but remember to use the leading equals sign</li>
<li>Structured table references are supported and recommended.  </li>
<li>Refer to this column with the VBA function <code>this_col_name()</code></li>
<li>Many VBA functions are designed to be used in formulas</li>
</ul>
<h4 id="highlights">Highlights</h4>
<p>For example the following puts a line between the actual and forecast periods. The anchor, (ampersand) allows other tables to use the same by using <code>*past_future</code></p>
<pre><code class="language-yaml">  highlights: 
    present: &amp;past_future
      formula: =A$2=get_val(&quot;first_forecast&quot;,&quot;tbl_gen_state&quot;,&quot;Value&quot;) # ref is to heading row
      border:
        edges: 
        - left
        style: thin
        color: B50000
</code></pre>
<h3 id="specific-sheets-tables">Specific Sheets &amp; Tables</h3>
<h4 id="inflation">Inflation</h4>
<p>You may want to consider a different series.  The default is all items in U.S. city average, all urban consumers, not seasonally adjusted.</p>
<h4 id="required-minimum-distributions">Required minimum distributions</h4>
<p>At the time of writing the best source seems to be the Federal Register.  This does not need to edited unless the source changes.  </p>
<h4 id="accounts">Accounts</h4>
<p>The data section in the <code>setup.yaml</code> needs the following sub-sections:</p>
<table>
<thead>
<tr>
<th align="left">Item</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="left">Path from the project root where to find the saved report`.  This should be one with all the accounts you wish to use.</td>
</tr>
<tr>
<td align="left">group</td>
<td align="left">this is a list of the summary levels you wish to use in your plan.  The items can either be the categories that Moneydance uses such as Bank Accounts, or it can be summary accounts that you have created (accounts that have sub-accounts)</td>
</tr>
<tr>
<td align="left">no_details_for</td>
<td align="left">If you have summary accounts that cover all the items in a category, then you can use those instead of the leaf accounts. By listing the category hear the detail accounts will be ignored.</td>
</tr>
<tr>
<td align="left">include_zeros</td>
<td align="left">Usually zero balance accounts will be ignored.  If the account is entered here, it will be carried forward.  This can be useful if its a brand new account with no balance or if its an old account that had a balance in the historical period.</td>
</tr>
<tr>
<td align="left">tax_free_keys</td>
<td align="left">A list of keywords that will be used to determine how the tax status of the account will be initialized.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<pre><code class="language-yaml">path: ./data/2022 Account Balances.tsv
group:
- Bank Accounts
- Credit Cards
- Real Estate
- Other Asset
- Liabilities
- Mortgage Loans
- Non Mort Loans
no_details_for:
- Assets
- Loans
include_zeros:
- My old HSA
- My old 401K
tax_free_keys:
- 401K
- &quot;529&quot;
- IRA
</code></pre>
<p>[^1]: The most recent is best so as to contain all current accounts. This is used to create the Accounts worksheet.  The balances are not used, except that when they are zero, the account will be ignored unless it is specifically mentiond in the <code>include_zeros</code> section of the YAML.</p>
<p>[^2]:  Another instance of the Account Balances is used to establish the opening balances on the Balances sheet. This may be for a different year.  If an earlier file is used, history can be included in the Balances sheet.</p>
<p>[^3]: All history years must be available in order to compute the flows to/from bank accounts and credit cards.</p>
<p>[^4]: 529 Distributions depend on the tag <code>529-Distr</code> being used to make distributions but not inheritance or transfers.  Thus on the iande table it defrays the college expenses.</p>
<p>[^5]: These data are used to compute medical payments made from HSA accounts by year.</p>
<p>[^6]: This is a transaction filter report using the tag <code>IRA-Txbl-Distr</code></p>
<p>[^7]: This is a transaction filter that selects income and expense categories that are required to only apply to investments.</p>
<p>[^8]: Investment actuals requires the transfers file and the performance files. It also depends on the data from the investment expenses to already be in place.</p>
<p>[^9]: This requires that if the Passthru account is used, it must only be used to transfer funds to/from banks.  In other words there is an assumption that it does not mask any movement to/from income or expense items.  Those must be directly in the investment account.</p>
<p>[^10]: Source accounts: All bank, credit card, income, expense and all HSA accounts. Target Accounts: All asset, liability &amp; loan. The HSA accounts (a subset of investments) are needed since they sometimes transfer to the medical providers.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../report_configs/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Report definitions" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Report definitions
            </div>
          </div>
        </a>
      
      
        
        <a href="../vba_index/" class="md-footer__link md-footer__link--next" aria-label="Next: VBA Code Summary" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              VBA Code Summary
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>