
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Data from Moneydance &#8212; Budget Dance 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/celery.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Appendix" href="appendix.html" />
    <link rel="prev" title="Setting up the spreadsheet" href="setup.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="appendix.html" title="Appendix"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Setting up the spreadsheet"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Budget Dance 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Data from Moneydance</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="data-from-moneydance">
<h1>Data from Moneydance<a class="headerlink" href="#data-from-moneydance" title="Permalink to this heading">¶</a></h1>
<section id="python-environment">
<h2>Python Environment<a class="headerlink" href="#python-environment" title="Permalink to this heading">¶</a></h2>
<p>In the terminal change the current directory to the root of the repository.
Use the following command to active the virtual environment: <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">.venv/bin/activate</span></code></p>
</section>
<section id="copy-income-and-expense-from-moneydance">
<h2>Copy Income and Expense from Moneydance<a class="headerlink" href="#copy-income-and-expense-from-moneydance" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>In Moneydance run <code class="docutils literal notranslate"><span class="pre">Income</span> <span class="pre">&amp;</span> <span class="pre">Expense</span> <span class="pre">by</span> <span class="pre">Year</span></code></p></li>
<li><p>Save as <code class="docutils literal notranslate"><span class="pre">data/iande.tsv</span></code></p></li>
<li><p>Close spreadsheet and run the program  <code class="docutils literal notranslate"><span class="pre">iande-actl-load.py</span></code></p></li>
<li><p>Ensure that the formulas on the year are set to <code class="docutils literal notranslate"><span class="pre">getval...</span></code></p></li>
<li><p>Check that income, tax and expense totals match to report:</p>
<ul class="simple">
<li><p>start at level 3 and drill down to find problems.</p></li>
<li><p>IRA distributions are problematic (see note IRA-Txbl-Distr - line)</p></li>
<li><p>If there are new categories - you will need to insert a line</p></li>
</ul>
</li>
</ol>
</section>
<section id="first-pass-on-the-taxes">
<h2>First pass on the taxes<a class="headerlink" href="#first-pass-on-the-taxes" title="Permalink to this heading">¶</a></h2>
<p>The first pass does not rely on the tax forms, those come later - basically the bits that are not accounted for are entered into the manual_actl tab.</p>
<ol class="arabic simple">
<li><p>Check W2 exclusions on aux</p></li>
<li><p>Change the column for the year to use the actuals</p></li>
<li><p>Carefully check the progression of the logic</p></li>
</ol>
</section>
<section id="copy-transfers-data-from-moneydance">
<h2>Copy transfers data from Moneydance<a class="headerlink" href="#copy-transfers-data-from-moneydance" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Run report in Moneydance (currently called Transfers-to-fcast.</p></li>
<li><p>Press Save button and choose Tab delimited and save as <code class="docutils literal notranslate"><span class="pre">data/transfers.tsv</span></code></p></li>
<li><p>(If a year has been completed run the Bank balance export procedure)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">fcast.xlsm</span></code> is open, save your work and close the file.</p></li>
<li><p>Open a terminal window at the project root.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">transfers_actl_load.py</span></code></p></li>
<li><p>Re-open the spreadsheet and save it to force balances to recalc and be stored.</p></li>
</ol>
</section>
<section id="bank-balance-export-procedure">
<h2>Bank balance export procedure<a class="headerlink" href="#bank-balance-export-procedure" title="Permalink to this heading">¶</a></h2>
<p>The method used is the difference of progressive balances.  This is done for each year.</p>
<ol class="arabic simple">
<li><p>In Moneydance run the <code class="docutils literal notranslate"><span class="pre">Account</span> <span class="pre">Balances</span></code> report selecting only banks and credit cards.</p></li>
<li><p>Save the file as tab-separated under <code class="docutils literal notranslate"><span class="pre">budget/data</span></code> as <code class="docutils literal notranslate"><span class="pre">bank-bal-YYYY</span></code>.</p></li>
<li><p>These files are consumed by the <code class="docutils literal notranslate"><span class="pre">transfers_actl_load.py</span></code> routine.</p></li>
</ol>
</section>
<section id="investment-actuals">
<h2>Investment actuals<a class="headerlink" href="#investment-actuals" title="Permalink to this heading">¶</a></h2>
<p>The Tranfers to Investment Accounts by Year report is saved as <code class="docutils literal notranslate"><span class="pre">invest_x.tsv</span></code>. The Investment Performance report for each year is saved under <code class="docutils literal notranslate"><span class="pre">invest-p-yyyy.tsv</span></code> for each year. These are processed by <code class="docutils literal notranslate"><span class="pre">invest_actl_load.py</span></code>. At each year end:</p>
<ol class="arabic simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">Tranfers</span> <span class="pre">to</span> <span class="pre">Investment</span> <span class="pre">Accounts</span> <span class="pre">by</span> <span class="pre">Year</span></code> and save as <code class="docutils literal notranslate"><span class="pre">invest_x.tsv</span></code></p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">Investment</span> <span class="pre">Performance</span></code> report for the year and save under <code class="docutils literal notranslate"><span class="pre">invest-p-yyyy.tsv</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">fcast.xlsm</span></code> is open, save your work and close the file.</p></li>
<li><p>Open a terminal window at the project root.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">invest_actl_load.py</span></code></p></li>
<li><p>Re-open the spreadsheet and save it to force balances to recalc and be stored.</p></li>
</ol>
</section>
<section id="validate-balances-for-a-year">
<h2>Validate balances for a year<a class="headerlink" href="#validate-balances-for-a-year" title="Permalink to this heading">¶</a></h2>
<p>The routine <code class="docutils literal notranslate"><span class="pre">balance_check.py</span></code> is available to see how the values from the <code class="docutils literal notranslate"><span class="pre">Account</span> <span class="pre">Balances</span></code> report in Moneydance match to those in <code class="docutils literal notranslate"><span class="pre">fcast.xlsm</span></code>.</p>
<ol class="arabic simple">
<li><p>In Moneydance run the <code class="docutils literal notranslate"><span class="pre">Account</span> <span class="pre">Balances</span></code> report selecting all accounts.</p></li>
<li><p>Save the report  under the names: <code class="docutils literal notranslate"><span class="pre">data/yyyy</span> <span class="pre">Account</span> <span class="pre">Balances.tsv</span></code>.</p></li>
<li><p>If the year has rolled over in the spreadsheet</p></li>
</ol>
<ul class="simple">
<li><p>change first_forecast_year in on the tables worksheet.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>In a terminal window set current directory to the project root and run <code class="docutils literal notranslate"><span class="pre">balance_check.py</span> <span class="pre">yyyy</span></code> where yyyy is the year to check.  You should get a listing that shows the exact matches and the accounts that don’t match (and how much they are off).</p></li>
</ol>
</section>
<section id="add-an-account">
<h2>Add an account<a class="headerlink" href="#add-an-account" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>On the accounts tab insert a row in the table</p></li>
<li><p>Fill in all fields (notes is optional). Usually, the account name is used for the actl_source</p></li>
<li><p>Create the rows on the balances table</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Steps</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Unhide all columns and sort by account name</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Insert 6 new rows.  Put the account name in the first row of the AcctName field.</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Copy down columns A, D, E, F from another account.</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Copy the 6 value types into column B</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Insert 6 copies of the new account name for each account in  column c</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Copy formulas into 1st active year</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Set the opening balance</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>When satisfied with actuals, copy formulas into 1st forecast period</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rename-an-account">
<h2>Rename an account<a class="headerlink" href="#rename-an-account" title="Permalink to this heading">¶</a></h2>
<p>It turns out to be useful to have an account naming convention.  The convention is
<em>type - owner - firm</em>
where type is 401K, 529, BKG, ESP, HSA, IRA, IRA Roth, MUT, BND<br/>and owner is JNT or the owner’s initials.</p>
<p>Notes</p>
<ul class="simple">
<li><p>BND is for - gov’t bonds where TRY is for treasury - direct</p></li>
</ul>
<p>Here’s what has to be done to rename an account.</p>
<ol class="arabic simple">
<li><p>The account name can be changed in Moneydance using the Tools -&gt; Accounts menu.</p></li>
<li><p>It must be changed in fcst.xlsm at the following locations</p>
<ol class="arabic simple">
<li><p>tbl_accounts - it occurs in the A column and may occur in the G column</p></li>
<li><p>tbl_balances</p></li>
</ol>
</li>
<li><p>Depending on the account it may occur in the following location</p>
<ol class="arabic simple">
<li><p>tbl_retir,</p></li>
<li><p>tbl_retir_parms</p></li>
</ol>
</li>
<li><p>The following should be refreshed: tbl_transfers_actl by running the procedure</p></li>
</ol>
</section>
<section id="accounting">
<h2>Accounting<a class="headerlink" href="#accounting" title="Permalink to this heading">¶</a></h2>
<p>The computation of balances depends on the ability to determine the changes to the accounts.  The “Other Asset” account has several sub-accounts, including receivables from a few parties.  The method of determining the transfers depends is to use the <code class="docutils literal notranslate"><span class="pre">transfers-to-fcast</span></code> memorized report.  Some of the sub-accounts in Other Asset have transactions using expense categories.  To support this the memorized report includes all expenses in the criteria.  This correctly gathers the amounts such as depreciation for cars and payments made against some expense category (on our behalf).  The set of a target accounts configured in this report includes all investment, loan, asset and liability accounts.   Whenever there is a transfer between these accounts, this method essentially cancels out that values, which can lead to wrong balances.  Such transactions should be routed throught the <code class="docutils literal notranslate"><span class="pre">Passthru</span></code> bank account to avoid this problem.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Data from Moneydance</a><ul>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
<li><a class="reference internal" href="#copy-income-and-expense-from-moneydance">Copy Income and Expense from Moneydance</a></li>
<li><a class="reference internal" href="#first-pass-on-the-taxes">First pass on the taxes</a></li>
<li><a class="reference internal" href="#copy-transfers-data-from-moneydance">Copy transfers data from Moneydance</a></li>
<li><a class="reference internal" href="#bank-balance-export-procedure">Bank balance export procedure</a></li>
<li><a class="reference internal" href="#investment-actuals">Investment actuals</a></li>
<li><a class="reference internal" href="#validate-balances-for-a-year">Validate balances for a year</a></li>
<li><a class="reference internal" href="#add-an-account">Add an account</a></li>
<li><a class="reference internal" href="#rename-an-account">Rename an account</a></li>
<li><a class="reference internal" href="#accounting">Accounting</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="setup.html"
                          title="previous chapter">Setting up the spreadsheet</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="appendix.html"
                          title="next chapter">Appendix</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/data_from_moneydance.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="appendix.html" title="Appendix"
             >next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Setting up the spreadsheet"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Budget Dance 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Data from Moneydance</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, George Dobbs.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
  </body>
</html>